 “tcfa” needs two input files. One contains one or more “templates”. It is desirable, but not necessary, that the template structures have some meaningful mutual alignment (see the PLOS reference). The other contains the “candidate” structures that are to be aligned, for use by “comfa” in model building and/or prediction. (These must also be 3D structures, as produced by Omega or Concord, although only at most these valence geometries will be preserved). The only output file produced by “tcfa” of course contains the template-CoMFA aligned structures.This “tcfa” alignment algorithm significantly differs from the one described in the references, but produces very similar model qualities. Alignment of a candidate begins by seeking its highest scoring MCS with one of the templates, in a two-stage process, the first requiring high atom/bond similarity, and then extended by matching connectivity only. Every one of the atoms in the first-pass portion of this “best MCS” are potential root, or embedment, atoms. The geometries of the template atoms in the MCS are “copied” onto the candidate, in an atom-by-atom traversal but with candidate rings treated as “atoms”. Finally the topomer canonicalization is applied to those candidate atoms which are not included in the “best MCS”. The alignment that yields the smallest candidate-template RMSD for the atoms within the MSS, among all the possible root atoms, is the result. It is of course possible, though surprisingly infrequent, that a candidate’s MCS with ever one of the templates is too poor to allow an alignment to be produced.As with any OE-based program, tcfa’s command line options can be inspected by invoking it with the “—help” option. Only two seem to require further explanation.  The “dis” parameter crudely addresses a fundamental tension in template CoMFA alignments. Suppose a candidate replaces a –CH2Ph group in the template with –SO2Ph. Should the C-S bonds in the candidate be shortened so that the –Ph groups coincide? Opinion varies. This “dis” parameter is a threshold – if existing valence geometries differ in the positioning of an atom by more than its value, the candidate atom will be moved for better superposition onto the template atom.The “featwt” parameter invokes a list of feature types, as SMILES strings, to which mismatches are less penalized while choosing the single best MCS. The default such feature types can be found and edited as “kTypes” and “kScore”, within “tcfa.cpp”.If the results from aligning a homologous series seem too scattered, the likely cause is that because template CoMFA alignment is strictly one-candidate-at-a-time, different series members may be rooted differently. To control the scope of root atoms, for example to an –SO2NH2 group common to all series members, add the attribute “SmartsTC” to your template structure, in this example with the value “NS(=O)(=O)”. The SO2NH2 fragments will then superimpose perfectly.  